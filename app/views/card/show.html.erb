<%- 
slot = get_slot
item = symbolize_param(:item) and slot.item_format = item
view = symbolize_param(:view) 
view = :open if [:open,:card,:view, nil].member?(view)  
if slot.card.new_record? && !slot.card.virtual?
	view = "#{view}_missing".to_sym
else
	view = view.to_s.gsub(/_missing/,'').to_sym
end
%>

<%= slot.render(view, :add_javascript=>true, :add_slot=>false, :view=>view, :showname=>nil ) %>
<% if view == :open %>
  <%= javascript_tag("Wagn.line_to_paragraph(getSlotFromContext('#{@context}'))") %>
<% elsif view == :closed %>
	<%= javascript_tag("Wagn.paragraph_to_line(getSlotFromContext('#{@context}'))") %>
<% end %>
